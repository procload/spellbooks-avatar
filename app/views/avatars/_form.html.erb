<%= form_with model: form_object, url: form_url, method: form_method do |f| %>
  <% if form_object.errors.any? %>
    <%= render EldritchUi::BannerComponent.new(variant: :error) do %>
      <h2><%= pluralize(form_object.errors.count, "error") %> prevented this avatar from being saved:</h2>
      <ul>
        <% form_object.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    <% end %>
  <% end %>

  <%= render EldritchUi::TextInputComponent.new(
    name: "avatar[name]",
    value: form_object.name,
    label: "Name",
    required: true,
    error_message: form_object.errors[:name].first
  ) %>

  <div class="pill-toggle-group" data-controller="pill-toggle">
    <label class="pill-toggle-group__label">Gender</label>
    <div class="pill-toggle-group__pills">
      <% (@genders || []).each do |gender| %>
        <label class="eld-pill eld-pill--interactive <%= 'eld-pill--selected' if form_object.gender == gender %>"
               data-pill-toggle-target="pill"
               data-action="click->pill-toggle#toggle">
          <input type="radio"
                 name="avatar[gender]"
                 value="<%= gender %>"
                 <%= 'checked' if form_object.gender == gender %>
                 data-pill-toggle-target="input"
                 style="position: absolute; opacity: 0; pointer-events: none;">
          <%= gender.humanize %>
        </label>
      <% end %>
    </div>
  </div>

  <%= render EldritchUi::SelectComponent.new(
    name: "avatar[klass]",
    value: form_object.klass,
    options: @classes,
    label: "Class",
    required: true,
    error_message: form_object.errors[:klass].first
  ) %>

  <div class="pill-toggle-group" data-controller="pill-toggle">
    <label class="pill-toggle-group__label">Fun traits</label>
    <div class="pill-toggle-group__pills">
      <% (@traits || []).each do |trait| %>
        <% is_selected = Array(form_object.traits).include?(trait) %>
        <label class="eld-pill eld-pill--interactive <%= 'eld-pill--selected' if is_selected %>"
               data-pill-toggle-target="pill"
               data-action="click->pill-toggle#toggle">
          <input type="checkbox"
                 name="avatar[traits][]"
                 value="<%= trait %>"
                 <%= 'checked' if is_selected %>
                 data-pill-toggle-target="input"
                 style="position: absolute; opacity: 0; pointer-events: none;">
          <%= trait %>
        </label>
      <% end %>
    </div>
  </div>

  <%= render EldritchUi::ButtonComponent.new(
    label: submit_label,
    variant: :primary,
    size: :medium,
    type: "submit",
    data: { turbo: false }
  ) %>
<% end %>
